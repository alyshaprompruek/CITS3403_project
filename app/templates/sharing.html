{% extends "base.html" %}

{% block head %}
  <title>Sharing | Grade Tracker</title>
  <script src="{{ url_for('static', filename='sharing.js') }}"></script>
{% endblock %}

{% block body %}
<div class="container py-5">
  <h2 class="text-center mb-4">Sharing Management</h2>

  <!-- Outgoing Shares -->
  <div class="card mb-5">
    <div class="card-header bg-primary text-white">
      <h5 class="mb-0">I Shared With</h5>
    </div>
    <div class="card-body">
      <div class="mb-3 text-end">
        <button class="btn btn-success" onclick="openNewShareModal()">+ Share Dashboard</button>
      </div>
      <table class="table table-bordered table-hover">
        <thead class="table-light">
          <tr>
            <th>Email</th>
            <th>Link</th>
            <th>Expires</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody id="outgoingSharesTable">
          <!-- Dynamically populated -->
        </tbody>
      </table>
    </div>
  </div>

  <!-- Incoming Shares -->
  <div class="card">
    <div class="card-header bg-secondary text-white">
      <h5 class="mb-0">Shared With Me</h5>
    </div>
    <div class="card-body">
      <table class="table table-bordered">
        <thead class="table-light">
          <tr>
            <th>From</th>
            <th>View</th>
          </tr>
        </thead>
        <tbody id="incomingSharesTable">
          <!-- Dynamically populated -->
        </tbody>
      </table>
    </div>
  </div>
</div>

<!-- Modal for New Share -->
<div class="modal hidden" id="newShareModal">
  <div class="modal-content bg-dark text-white">
    <h4 class="mb-3">Share Dashboard</h4>
    <div class="form-group mb-3">
      <label for="shareEmailInput" class="form-label">Recipient Email:</label>
      <input type="email" id="shareEmailInput" class="form-control bg-dark text-white border-secondary" placeholder="e.g., test@gmail.com">
    </div>
    <div class="form-group mb-4">
      <label for="expiryDateInput" class="form-label">Expiry Date:</label>
      <input type="date" id="expiryDateInput" class="form-control bg-dark text-white border-secondary">
    </div>
    <div class="d-flex justify-content-between">
      <button class="btn btn-success" onclick="confirmNewShare()">Confirm</button>
      <button class="btn btn-secondary" onclick="closeNewShareModal()">Cancel</button>
    </div>
  </div>
</div>

<style>
.modal {
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: rgba(0,0,0,0.7);
  display: flex; align-items: center; justify-content: center;
  z-index: 1050;
}
.modal.hidden {
  display: none;
}
.modal-content {
  background: #212529;
  padding: 25px;
  border-radius: 10px;
  text-align: center;
  max-width: 500px;
  width: 90%;
  box-shadow: 0 0 20px rgba(0,0,0,0.5);
}
</style>
{% endblock %}
